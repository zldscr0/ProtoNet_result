2023-10-08 20:54:44,717 [INFO] core.test: {'data_root': '/home/bzx_yjy/FS/miniImageNet--ravi', 'image_size': 84, 'use_memory': False, 'augment': True, 'augment_times': 1, 'augment_times_query': 1, 'workers': 8, 'dataloader_num': 1, 'device_ids': '0,1', 'n_gpu': 2, 'seed': 2147483647, 'deterministic': True, 'port': 30537, 'log_name': None, 'log_level': 'info', 'log_interval': 100, 'log_paramerter': False, 'result_root': './results', 'save_interval': 10, 'save_part': ['emb_func'], 'tag': None, 'epoch': 50, 'test_epoch': 5, 'parallel_part': ['emb_func'], 'pretrain_path': None, 'resume': False, 'way_num': 5, 'shot_num': 5, 'query_num': 15, 'test_way': 5, 'test_shot': 5, 'test_query': 15, 'episode_size': 2, 'train_episode': 10000, 'test_episode': 600, 'batch_size': 128, 'val_per_epoch': 1, 'optimizer': {'kwargs': {'lr': 0.01}, 'name': 'SGD', 'other': None}, 'lr_scheduler': {'kwargs': {'gamma': 1.0, 'step_size': 20}, 'name': 'StepLR'}, 'warmup': 0, 'includes': ['headers/data.yaml', 'headers/device.yaml', 'headers/misc.yaml', 'headers/model.yaml', 'headers/optimizer.yaml', 'classifiers/Proto.yaml', 'backbones/resnet12.yaml'], 'backbone': {'kwargs': {'is_feature': False, 'is_flatten': True, 'last_pool': True, 'leaky_relu': False, 'negative_slope': 0.2}, 'name': 'Conv64F'}, 'classifier': {'kwargs': None, 'name': 'ProtoNet'}, 'rank': 0, 'tb_scale': 16.666666666666668}
2023-10-08 20:54:44,740 [INFO] core.test: ProtoNet(
  (emb_func): Conv64F(
    (layer1): Sequential(
      (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
      (3): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    )
    (layer2): Sequential(
      (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
      (3): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    )
    (layer3): Sequential(
      (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
    )
    (layer3_maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (layer4): Sequential(
      (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
    )
    (layer4_pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (proto_layer): ProtoLayer()
  (loss_func): CrossEntropyLoss()
)
2023-10-08 20:54:44,754 [INFO] core.test: Trainable params in the model: 113088.
2023-10-08 20:54:44,756 [INFO] core.test: Loading the state dict from ./results/ProtoNet-miniImageNet--ravi-Conv64F-5-5-Oct-08-2023-14-33-47/checkpoints/model_best.pth.
2023-10-08 20:54:44,848 [INFO] core.test: load 12000 test image with 20 label.
2023-10-08 20:54:55,635 [INFO] core.test: ============ Testing on the test set ============
2023-10-08 20:55:06,599 [INFO] core.test: Epoch-(0): [100/600]	Time 0.115 (0.219)	Calc 0.013 (0.159)	Data 0.100 (0.058)	Acc@1 62.000 (65.280)
2023-10-08 20:55:12,439 [INFO] core.test: Epoch-(0): [200/600]	Time 0.268 (0.167)	Calc 0.007 (0.100)	Data 0.259 (0.065)	Acc@1 66.667 (65.860)
2023-10-08 20:55:17,962 [INFO] core.test: Epoch-(0): [300/600]	Time 0.266 (0.148)	Calc 0.015 (0.081)	Data 0.248 (0.065)	Acc@1 58.000 (66.053)
2023-10-08 20:55:24,221 [INFO] core.test: Epoch-(0): [400/600]	Time 0.017 (0.142)	Calc 0.006 (0.066)	Data 0.002 (0.074)	Acc@1 66.667 (66.233)
2023-10-08 20:55:29,819 [INFO] core.test: Epoch-(0): [500/600]	Time 0.261 (0.136)	Calc 0.174 (0.063)	Data 0.086 (0.071)	Acc@1 68.667 (66.397)
2023-10-08 20:55:36,015 [INFO] core.test: Epoch-(0): [600/600]	Time 0.016 (0.134)	Calc 0.013 (0.069)	Data 0.001 (0.062)	Acc@1 63.333 (66.111)
2023-10-08 20:55:36,022 [INFO] core.test: Test Accuracy: 66.111	 h: 0.691
2023-10-08 20:55:36,024 [INFO] core.test: ============ Testing on the test set ============
2023-10-08 20:55:42,596 [INFO] core.test: Epoch-(1): [100/600]	Time 0.017 (0.131)	Calc 0.014 (0.121)	Data 0.000 (0.007)	Acc@1 66.000 (65.893)
2023-10-08 20:55:49,187 [INFO] core.test: Epoch-(1): [200/600]	Time 0.012 (0.131)	Calc 0.009 (0.104)	Data 0.002 (0.025)	Acc@1 68.000 (65.627)
2023-10-08 20:55:54,871 [INFO] core.test: Epoch-(1): [300/600]	Time 0.009 (0.125)	Calc 0.007 (0.104)	Data 0.001 (0.018)	Acc@1 63.333 (65.653)
2023-10-08 20:56:00,965 [INFO] core.test: Epoch-(1): [400/600]	Time 0.373 (0.124)	Calc 0.371 (0.095)	Data 0.001 (0.027)	Acc@1 60.000 (65.263)
2023-10-08 20:56:06,989 [INFO] core.test: Epoch-(1): [500/600]	Time 0.011 (0.123)	Calc 0.008 (0.098)	Data 0.001 (0.023)	Acc@1 74.000 (65.373)
2023-10-08 20:56:13,540 [INFO] core.test: Epoch-(1): [600/600]	Time 0.211 (0.124)	Calc 0.207 (0.102)	Data 0.002 (0.020)	Acc@1 65.333 (65.118)
2023-10-08 20:56:13,547 [INFO] core.test: Test Accuracy: 65.118	 h: 0.663
2023-10-08 20:56:13,549 [INFO] core.test: ============ Testing on the test set ============
2023-10-08 20:56:18,908 [INFO] core.test: Epoch-(2): [100/600]	Time 0.238 (0.106)	Calc 0.009 (0.044)	Data 0.226 (0.059)	Acc@1 77.333 (66.840)
2023-10-08 20:56:24,654 [INFO] core.test: Epoch-(2): [200/600]	Time 0.009 (0.110)	Calc 0.006 (0.068)	Data 0.001 (0.039)	Acc@1 64.667 (66.140)
2023-10-08 20:56:30,739 [INFO] core.test: Epoch-(2): [300/600]	Time 0.027 (0.114)	Calc 0.021 (0.082)	Data 0.004 (0.029)	Acc@1 72.000 (65.822)
2023-10-08 20:56:37,481 [INFO] core.test: Epoch-(2): [400/600]	Time 0.019 (0.119)	Calc 0.016 (0.065)	Data 0.001 (0.051)	Acc@1 63.333 (65.833)
2023-10-08 20:56:42,405 [INFO] core.test: Epoch-(2): [500/600]	Time 0.009 (0.115)	Calc 0.006 (0.064)	Data 0.000 (0.048)	Acc@1 65.333 (66.107)
2023-10-08 20:56:48,955 [INFO] core.test: Epoch-(2): [600/600]	Time 0.017 (0.117)	Calc 0.013 (0.072)	Data 0.001 (0.043)	Acc@1 72.000 (65.840)
2023-10-08 20:56:48,963 [INFO] core.test: Test Accuracy: 65.840	 h: 0.653
2023-10-08 20:56:48,965 [INFO] core.test: ============ Testing on the test set ============
2023-10-08 20:56:54,810 [INFO] core.test: Epoch-(3): [100/600]	Time 0.315 (0.116)	Calc 0.311 (0.110)	Data 0.002 (0.004)	Acc@1 76.000 (65.960)
2023-10-08 20:57:01,195 [INFO] core.test: Epoch-(3): [200/600]	Time 0.014 (0.122)	Calc 0.012 (0.116)	Data 0.001 (0.004)	Acc@1 66.667 (65.653)
2023-10-08 20:57:06,193 [INFO] core.test: Epoch-(3): [300/600]	Time 0.009 (0.114)	Calc 0.007 (0.109)	Data 0.001 (0.003)	Acc@1 64.000 (65.747)
2023-10-08 20:57:12,495 [INFO] core.test: Epoch-(3): [400/600]	Time 0.322 (0.117)	Calc 0.042 (0.101)	Data 0.277 (0.013)	Acc@1 61.333 (65.910)
2023-10-08 20:57:18,107 [INFO] core.test: Epoch-(3): [500/600]	Time 0.047 (0.116)	Calc 0.041 (0.091)	Data 0.004 (0.022)	Acc@1 76.667 (66.259)
2023-10-08 20:57:23,601 [INFO] core.test: Epoch-(3): [600/600]	Time 0.031 (0.115)	Calc 0.027 (0.085)	Data 0.001 (0.027)	Acc@1 58.667 (65.962)
2023-10-08 20:57:23,608 [INFO] core.test: Test Accuracy: 65.962	 h: 0.663
2023-10-08 20:57:23,610 [INFO] core.test: ============ Testing on the test set ============
2023-10-08 20:57:29,801 [INFO] core.test: Epoch-(4): [100/600]	Time 0.017 (0.123)	Calc 0.014 (0.109)	Data 0.001 (0.012)	Acc@1 59.333 (65.187)
2023-10-08 20:57:35,832 [INFO] core.test: Epoch-(4): [200/600]	Time 0.016 (0.122)	Calc 0.013 (0.101)	Data 0.001 (0.018)	Acc@1 71.333 (64.873)
2023-10-08 20:57:41,788 [INFO] core.test: Epoch-(4): [300/600]	Time 0.010 (0.121)	Calc 0.008 (0.080)	Data 0.001 (0.038)	Acc@1 68.667 (65.351)
2023-10-08 20:57:47,715 [INFO] core.test: Epoch-(4): [400/600]	Time 0.017 (0.120)	Calc 0.015 (0.068)	Data 0.001 (0.050)	Acc@1 63.333 (65.483)
2023-10-08 20:57:53,310 [INFO] core.test: Epoch-(4): [500/600]	Time 0.014 (0.118)	Calc 0.011 (0.067)	Data 0.001 (0.048)	Acc@1 74.667 (65.531)
2023-10-08 20:57:59,614 [INFO] core.test: Epoch-(4): [600/600]	Time 0.372 (0.119)	Calc 0.254 (0.068)	Data 0.115 (0.049)	Acc@1 66.667 (65.518)
2023-10-08 20:57:59,622 [INFO] core.test: Test Accuracy: 65.518	 h: 0.659
2023-10-08 20:57:59,627 [INFO] core.test: Aver Accuracy: 65.710	 Aver h: 0.297
2023-10-08 20:57:59,628 [INFO] core.test: ............Testing is end............
