2023-10-08 20:14:29,916 [INFO] core.test: {'data_root': '/home/bzx_yjy/FS/miniImageNet--ravi', 'image_size': 84, 'use_memory': False, 'augment': True, 'augment_times': 1, 'augment_times_query': 1, 'workers': 8, 'dataloader_num': 1, 'device_ids': '0,1', 'n_gpu': 2, 'seed': 2147483647, 'deterministic': True, 'port': 29588, 'log_name': None, 'log_level': 'info', 'log_interval': 100, 'log_paramerter': False, 'result_root': './results', 'save_interval': 10, 'save_part': ['emb_func'], 'tag': None, 'epoch': 50, 'test_epoch': 5, 'parallel_part': ['emb_func'], 'pretrain_path': None, 'resume': False, 'way_num': 5, 'shot_num': 5, 'query_num': 15, 'test_way': 5, 'test_shot': 5, 'test_query': 15, 'episode_size': 2, 'train_episode': 100, 'test_episode': 600, 'batch_size': 128, 'val_per_epoch': 1, 'optimizer': {'kwargs': {'lr': 0.01}, 'name': 'SGD', 'other': None}, 'lr_scheduler': {'kwargs': {'gamma': 1.0, 'step_size': 20}, 'name': 'StepLR'}, 'warmup': 0, 'includes': ['headers/data.yaml', 'headers/device.yaml', 'headers/misc.yaml', 'headers/model.yaml', 'headers/optimizer.yaml', 'classifiers/Proto.yaml', 'backbones/resnet12.yaml'], 'backbone': {'kwargs': {'is_feature': False, 'is_flatten': True, 'last_pool': True, 'leaky_relu': False, 'negative_slope': 0.2}, 'name': 'Conv64F'}, 'classifier': {'kwargs': None, 'name': 'ProtoNet'}, 'rank': 0, 'tb_scale': 0.16666666666666666}
2023-10-08 20:14:29,948 [INFO] core.test: ProtoNet(
  (emb_func): Conv64F(
    (layer1): Sequential(
      (0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
      (3): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    )
    (layer2): Sequential(
      (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
      (3): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    )
    (layer3): Sequential(
      (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
    )
    (layer3_maxpool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
    (layer4): Sequential(
      (0): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
      (1): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): ReLU(inplace=True)
    )
    (layer4_pool): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
  )
  (proto_layer): ProtoLayer()
  (loss_func): CrossEntropyLoss()
)
2023-10-08 20:14:29,958 [INFO] core.test: Trainable params in the model: 113088.
2023-10-08 20:14:29,959 [INFO] core.test: Loading the state dict from ./results/ProtoNet-miniImageNet--ravi-Conv64F-5-5-Oct-08-2023-09-21-03/checkpoints/model_best.pth.
2023-10-08 20:14:30,024 [INFO] core.test: load 12000 test image with 20 label.
2023-10-08 20:14:39,658 [INFO] core.test: ============ Testing on the test set ============
2023-10-08 20:14:50,609 [INFO] core.test: Epoch-(0): [100/600]	Time 0.139 (0.218)	Calc 0.135 (0.163)	Data 0.002 (0.053)	Acc@1 35.333 (38.160)
2023-10-08 20:14:55,681 [INFO] core.test: Epoch-(0): [200/600]	Time 0.014 (0.160)	Calc 0.010 (0.102)	Data 0.002 (0.054)	Acc@1 44.667 (37.667)
2023-10-08 20:15:00,931 [INFO] core.test: Epoch-(0): [300/600]	Time 0.020 (0.141)	Calc 0.014 (0.072)	Data 0.002 (0.066)	Acc@1 40.000 (37.551)
2023-10-08 20:15:05,864 [INFO] core.test: Epoch-(0): [400/600]	Time 0.172 (0.130)	Calc 0.011 (0.059)	Data 0.159 (0.068)	Acc@1 41.333 (37.657)
2023-10-08 20:15:11,105 [INFO] core.test: Epoch-(0): [500/600]	Time 0.014 (0.125)	Calc 0.010 (0.060)	Data 0.001 (0.062)	Acc@1 35.333 (37.661)
2023-10-08 20:15:16,262 [INFO] core.test: Epoch-(0): [600/600]	Time 0.013 (0.121)	Calc 0.010 (0.053)	Data 0.001 (0.065)	Acc@1 40.667 (37.647)
2023-10-08 20:15:16,268 [INFO] core.test: Test Accuracy: 37.647	 h: 0.641
2023-10-08 20:15:16,270 [INFO] core.test: ============ Testing on the test set ============
2023-10-08 20:15:20,910 [INFO] core.test: Epoch-(1): [100/600]	Time 0.168 (0.092)	Calc 0.164 (0.075)	Data 0.001 (0.015)	Acc@1 36.000 (37.853)
2023-10-08 20:15:25,847 [INFO] core.test: Epoch-(1): [200/600]	Time 0.019 (0.095)	Calc 0.014 (0.076)	Data 0.001 (0.017)	Acc@1 36.667 (37.947)
2023-10-08 20:15:30,576 [INFO] core.test: Epoch-(1): [300/600]	Time 0.328 (0.095)	Calc 0.014 (0.055)	Data 0.309 (0.037)	Acc@1 38.000 (37.724)
2023-10-08 20:15:35,174 [INFO] core.test: Epoch-(1): [400/600]	Time 0.019 (0.094)	Calc 0.013 (0.044)	Data 0.001 (0.046)	Acc@1 41.333 (37.820)
2023-10-08 20:15:39,826 [INFO] core.test: Epoch-(1): [500/600]	Time 0.017 (0.093)	Calc 0.012 (0.040)	Data 0.002 (0.050)	Acc@1 44.000 (37.864)
2023-10-08 20:15:44,639 [INFO] core.test: Epoch-(1): [600/600]	Time 0.270 (0.094)	Calc 0.015 (0.037)	Data 0.252 (0.054)	Acc@1 36.000 (37.700)
2023-10-08 20:15:44,648 [INFO] core.test: Test Accuracy: 37.700	 h: 0.587
2023-10-08 20:15:44,650 [INFO] core.test: ============ Testing on the test set ============
2023-10-08 20:15:49,362 [INFO] core.test: Epoch-(2): [100/600]	Time 0.017 (0.094)	Calc 0.012 (0.013)	Data 0.002 (0.077)	Acc@1 32.667 (37.480)
2023-10-08 20:15:54,750 [INFO] core.test: Epoch-(2): [200/600]	Time 0.350 (0.100)	Calc 0.015 (0.014)	Data 0.330 (0.083)	Acc@1 34.000 (37.707)
2023-10-08 20:16:00,074 [INFO] core.test: Epoch-(2): [300/600]	Time 0.014 (0.102)	Calc 0.009 (0.014)	Data 0.002 (0.085)	Acc@1 47.333 (37.453)
2023-10-08 20:16:05,151 [INFO] core.test: Epoch-(2): [400/600]	Time 0.096 (0.102)	Calc 0.012 (0.014)	Data 0.081 (0.085)	Acc@1 26.000 (36.917)
2023-10-08 20:16:10,316 [INFO] core.test: Epoch-(2): [500/600]	Time 0.013 (0.102)	Calc 0.011 (0.014)	Data 0.001 (0.085)	Acc@1 39.333 (36.824)
2023-10-08 20:16:15,127 [INFO] core.test: Epoch-(2): [600/600]	Time 0.184 (0.101)	Calc 0.181 (0.014)	Data 0.001 (0.083)	Acc@1 40.000 (37.093)
2023-10-08 20:16:15,133 [INFO] core.test: Test Accuracy: 37.093	 h: 0.651
2023-10-08 20:16:15,135 [INFO] core.test: ============ Testing on the test set ============
2023-10-08 20:16:19,835 [INFO] core.test: Epoch-(3): [100/600]	Time 0.018 (0.093)	Calc 0.015 (0.032)	Data 0.001 (0.059)	Acc@1 28.667 (36.747)
2023-10-08 20:16:24,869 [INFO] core.test: Epoch-(3): [200/600]	Time 0.072 (0.097)	Calc 0.011 (0.023)	Data 0.057 (0.071)	Acc@1 36.000 (37.040)
2023-10-08 20:16:29,809 [INFO] core.test: Epoch-(3): [300/600]	Time 0.019 (0.097)	Calc 0.014 (0.022)	Data 0.002 (0.072)	Acc@1 36.667 (37.320)
2023-10-08 20:16:34,788 [INFO] core.test: Epoch-(3): [400/600]	Time 0.181 (0.098)	Calc 0.014 (0.020)	Data 0.164 (0.074)	Acc@1 42.667 (37.970)
2023-10-08 20:16:39,877 [INFO] core.test: Epoch-(3): [500/600]	Time 0.254 (0.098)	Calc 0.250 (0.031)	Data 0.001 (0.064)	Acc@1 30.000 (38.067)
2023-10-08 20:16:45,350 [INFO] core.test: Epoch-(3): [600/600]	Time 0.021 (0.100)	Calc 0.016 (0.029)	Data 0.002 (0.068)	Acc@1 40.000 (38.193)
2023-10-08 20:16:45,367 [INFO] core.test: Test Accuracy: 38.193	 h: 0.632
2023-10-08 20:16:45,370 [INFO] core.test: ============ Testing on the test set ============
2023-10-08 20:16:51,019 [INFO] core.test: Epoch-(4): [100/600]	Time 0.274 (0.112)	Calc 0.270 (0.100)	Data 0.002 (0.010)	Acc@1 26.000 (37.427)
2023-10-08 20:16:56,514 [INFO] core.test: Epoch-(4): [200/600]	Time 0.016 (0.111)	Calc 0.013 (0.103)	Data 0.001 (0.006)	Acc@1 31.333 (37.127)
2023-10-08 20:17:02,581 [INFO] core.test: Epoch-(4): [300/600]	Time 0.420 (0.114)	Calc 0.415 (0.103)	Data 0.001 (0.009)	Acc@1 34.667 (36.818)
2023-10-08 20:17:07,916 [INFO] core.test: Epoch-(4): [400/600]	Time 0.017 (0.112)	Calc 0.014 (0.102)	Data 0.001 (0.008)	Acc@1 45.333 (36.757)
2023-10-08 20:17:12,884 [INFO] core.test: Epoch-(4): [500/600]	Time 0.167 (0.110)	Calc 0.122 (0.098)	Data 0.043 (0.009)	Acc@1 37.333 (37.051)
2023-10-08 20:17:18,278 [INFO] core.test: Epoch-(4): [600/600]	Time 0.112 (0.109)	Calc 0.108 (0.091)	Data 0.002 (0.015)	Acc@1 36.000 (37.076)
2023-10-08 20:17:18,287 [INFO] core.test: Test Accuracy: 37.076	 h: 0.662
2023-10-08 20:17:18,294 [INFO] core.test: Aver Accuracy: 37.542	 Aver h: 0.284
2023-10-08 20:17:18,296 [INFO] core.test: ............Testing is end............
